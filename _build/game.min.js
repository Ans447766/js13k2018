var e;e=function(){var e=function(){function t(e){return n.appendChild(e.dom),e}function r(e){for(var t=0;t<n.children.length;t++)n.children[t].style.display=t===e?"block":"none";o=e}var o=0,n=document.createElement("div");n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",function(e){e.preventDefault(),r(++o%n.children.length)},!1);var a=(performance||Date).now(),i=a,l=0,s=t(new e.Panel("FPS","#0ff","#002")),u=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new e.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:n,addPanel:t,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){l++;var e=(performance||Date).now();if(u.update(e-a,200),e>i+1e3&&(s.update(1e3*l/(e-i),100),i=e,l=0,c)){var t=performance.memory;c.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:n,setMode:r}};return e.Panel=function(e,t,r){var o=1/0,n=0,a=Math.round,i=a(window.devicePixelRatio||1),l=80*i,s=48*i,u=3*i,c=2*i,f=3*i,d=15*i,p=74*i,y=30*i,h=document.createElement("canvas");h.width=l,h.height=s,h.style.cssText="width:80px;height:48px";var w=h.getContext("2d");return w.font="bold "+9*i+"px Helvetica,Arial,sans-serif",w.textBaseline="top",w.fillStyle=r,w.fillRect(0,0,l,s),w.fillStyle=t,w.fillText(e,u,c),w.fillRect(f,d,p,y),w.fillStyle=r,w.globalAlpha=.9,w.fillRect(f,d,p,y),{dom:h,update:function(s,v){o=Math.min(o,s),n=Math.max(n,s),w.fillStyle=r,w.globalAlpha=1,w.fillRect(0,0,l,d),w.fillStyle=t,w.fillText(a(s)+" "+e+" ("+a(o)+"-"+a(n)+")",u,c),w.drawImage(h,f+i,d,p-i,y,f,d,p-i,y),w.fillRect(f+p-i,d,i,y),w.fillStyle=r,w.globalAlpha=.9,w.fillRect(f+p-i,d,i,a((1-s/v)*y))}}},e},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):this.Stats=e(),function(){const e=256,r=256,o=e*r,n=o,a=2*o,i=6*o,l=8*o;S=Math.sin,C=Math.cos,viewX=0,viewY=0,viewW=e,viewH=r,cursorX=0,cursorY=0,cursorColor=22,cursorColor2=0,floodStack=[],fontString="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_!@#.'\"?/<()",fontBitmap="11111100011111110001100011111010001111101000111110111111000010000100000111111100100101000110001111101111110000111001000011111111111000011100100001000011111100001011110001111111000110001111111000110001111110010000100001001111111111000100001010010111101000110010111001001010001100001000010000100001111110001110111010110001100011000111001101011001110001011101000110001100010111011110100011001011100100000111010001100011001001111111101000111110100011000101111100000111000001111101111100100001000010000100100011000110001100010111010001100011000101010001001000110001101011010101110100010101000100010101000110001010100010000100001001111100010001000100011111001000110000100001000111001110100010001000100111111111000001001100000111110100101001011111000100001011111100001111000001111100111110000111101000101110111110000100010001000010001110100010111010001011100111010001011110000101110011101000110001100010111000000000000000000000111110010000100001000000000100111111000110111101011011101010111110101011111010100000000000000000000000100001100001000100000000000011011010011001000000000000111010001001100000000100000010001000100010001000000010001000100000100000100001000100001000010000010",dither=[65535,65527,65015,65013,62965,62901,58805,58789,42405,42401,42145,42144,41120,40992,32800,32768,0],pat=65535,palDefault=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63];var s=document.getElementById("canvas"),u=document.createElement("canvas"),c=u.getContext("2d"),f=s.getContext("2d"),d=0,p=a,y=[4278715910,4279439380,4280620859,4281145203,4280950964,4280499935,4278872826,4280001529,4282504703,4282449151,4284805846,4282637212,4281712985,4281245716,4282284570,4282077732,4280295442,4284757012,4291058728,4292779812,4291286560,4292607142,4294967295,4290835454,4290303738,4288127221,4285754088,4288367292,4286593657,4283642688,4281606692,4279901218,4280822578,4282073457,4282873275,4284720347,4288467700,4293583066,4291934643,4289696651,4287460717,4284634186,4282464563,4281541698,4281872731,4283585166,4285167034,4288919017,4294960867,4294688697,4293172100,4290678104,4286938439,4283328291,4284777522,4287475549,4290436242,4293064653,4289385188,4287344839,4284647072,4283787129,4282666586,4281612610];pal=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],f.imageSmoothingEnabled=!1,s.width=e,s.height=r;var h=f.getImageData(0,0,e,r),w=new ArrayBuffer(h.data.length),v=new Uint8Array(w),g=new Uint32Array(w),x=new Uint8Array(e*r*10);u.width=e,u.height=r;var m=c.getImageData(0,0,e,r),M=(new ArrayBuffer(h.data.length),new Uint8Array(w)),D=new Uint32Array(w),A=new AudioContext;function Y(t,o,n=64){return!(0-n>t||t>e+n||0-n>o||o>r+n)}function K(e=0,t=d){x.fill(e,t,t+o)}function X(e=cursorColor,t=cursorColor2){cursorColor=e,cursorColor2=t}function E(t,o){let n=(o|=0)%4*4+(t|=0)%4,a=pat&Math.pow(2,n),i=a?cursorColor:cursorColor2;0!=i&&(i>63&&(i=0),0>t|t>e-1||0>o|o>r-1||(x[d+o*e+t]=a?cursorColor:cursorColor2))}function I(t,r){let o=t%e,n=Math.floor(t/e)%4*4+o%4,a=pat&Math.pow(2,n)?cursorColor:cursorColor2;x[t]=a;let i=t+e,l=t-e,s=t-1,u=t+1;x[i]==r&&floodStack.push(i),x[l]==r&&floodStack.push(l),x[s]==r&&floodStack.push(s),x[u]==r&&floodStack.push(u)}function b(e,t,r,o,n=cursorColor,a=cursorColor2){cursorX=r,cursorY=o,cursorColor2=a,cursorColor=n;var i,l,s=(o|=0)-(t|=0),u=(r|=0)-(e|=0);if(0>s?(s=-s,l=-1):l=1,0>u?(u=-u,i=-1):i=1,s<<=1,u<<=1,E(e,t),u>s)for(var c=s-(u>>1);e!=r;)0>c||(t+=l,c-=u),c+=s,E(e+=i,t);else for(c=u-(s>>1);t!=o;)0>c||(e+=i,c-=s),c+=u,E(e,t+=l)}function P(e,t,r=5,o=cursorColor,n=cursorColor2){if(cursorColor2=n,cursorColor=o,e|=0,t|=0,o|=0,(r|=0)>=0){e|=0,t|=0,o|=0;var a=-(r|=0),i=0,l=2-2*r;do{b(e-a,t-i,e+a,t-i,o),b(e-a,t+i,e+a,t+i,o),(r=l)>i||(l+=2*++i+1),(r>a||l>i)&&(l+=2*++a+1)}while(0>a)}}function R(e,t,r=16,o=16,n=cursorColor,a=cursorColor2){cursorColor2=a,cursorColor=n,x1=0|e,y1=0|t,r|=0,o|=0,b(x1,y1,r,y1,n),b(r,y1,r,o,n),b(x1,o,r,o,n),b(x1,y1,x1,o,n)}function L(e,t,r=16,o=16,n=cursorColor,a=cursorColor2){cursorColor2=a,cursorColor=n,x1=0|e,y1=0|t,r|=0,n|=0;var i=(o|=0)-y1;if(b(x1,y1,r,y1,n),i>0)for(;--i;)b(x1,y1+i,r,y1+i,n);else if(0>i)for(;++i;)b(x1,y1+i,r,y1+i,n);b(x1,o,r,o,n)}function k(e){e[7]||(e[7]=1),e[8]||(e[8]=1);for(var r=e[0].length,o=0;r>o;o++){var n;l=e[0].charAt(o),index=fontString.indexOf(l),n=fontBitmap.substring(25*index,25*index+25).split("");for(var a=0;5>a;a++)for(var i=0;5>i;i++)if(1==n[5*a+i])if(1==e[4])E(e[1]+i*e[4]+(5*e[4]+e[3])*o,e[2]+(e[6]?Math.sin(1*(t+o*e[8])/e[7])*e[6]:0)+a*e[4]|0);else{let r=e[1]+i*e[4]+(5*e[4]+e[3])*o,n=e[2]+(e[6]?Math.sin(1*(t+o*e[8])/e[7])*e[6]:0)+a*e[4]|0;L(r,n,r+e[4],n+e[4],e[5])}}var l}function T(e){var t=5*e[7],r=e[0].split("\n"),o=r.slice(0),n=r.length,a=o.sort(function(e,t){return t.length-e.length})[0],i=a.length*t+(a.length-1)*e[3],l=n*t+(n-1)*e[4];e[5]||(e[5]="left"),e[6]||(e[6]="bottom");var s=e[1],u=e[2],c=e[1]+i,f=e[2]+l;"center"==e[5]?(s=e[1]-i/2,c=e[1]+i/2):"right"==e[5]&&(s=e[1]-i,c=e[1]),"center"==e[6]?(u=e[2]-l/2,f=e[2]+l/2):"bottom"==e[6]&&(u=e[2]-l,f=e[2]);for(var d=s+i/2,p=u+l/2,y=0;n>y;y++){var h=r[y],w=h.length*t+(h.length-1)*e[3],v=e[1],g=e[2]+(t+e[4])*y;"center"==e[5]?v=e[1]-w/2:"right"==e[5]&&(v=e[1]-w),"center"==e[6]?g-=l/2:"bottom"==e[6]&&(g-=l),k([h,v,g,e[3]||0,e[7]||1,e[8],e[9],e[10],e[11]])}return{sx:s,sy:u,cx:d,cy:p,ex:c,ey:f,width:i,height:l}}function z(e=Date.now(),t=1664525,r=1013904223,o=Math.pow(2,32)){this.seed=e,this.a=t,this.c=r,this.m=o}Number.prototype.clamp=function(e,t){return Math.min(Math.max(this,e),t)},Number.prototype.map=function(e,t,r,o){return(this-e)/(t-e)*(o-r)+r},Number.prototype.pad=function(e,t="0"){for(var r=String(this);r.length<(e||2);)r=t+r;return r},Key={_pressed:{},_released:{},LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,ONE:49,TWO:50,THREE:51,FOUR:52,a:65,c:67,w:87,s:83,d:68,z:90,x:88,f:70,p:80,r:82,isDown(e){return this._pressed[e]},justReleased(e){return this._released[e]},onKeydown(e){this._pressed[e.keyCode]=!0},onKeyup(e){this._released[e.keyCode]=!0,delete this._pressed[e.keyCode]},update(){this._released={}}},z.prototype.setSeed=function(e){this.seed=e},z.prototype.nextInt=function(){return this.seed=(this.seed*this.a+this.c)%this.m,this.seed},z.prototype.nextFloat=function(){return this.nextInt()/this.m},z.prototype.nextBool=function(e){return null==e&&(e=.5),this.nextFloat()<e},z.prototype.nextFloatRange=function(e,t){return e+this.nextFloat()*(t-e)},z.prototype.nextIntRange=function(e,t){return Math.floor(this.nextFloatRange(e,t))},z.prototype.nextColor=function(){for(var e=this.nextIntRange(0,Math.pow(2,24)).toString(16).toUpperCase();6>e.length;)e="0"+e;return"#"+e};var V=function(){var e,t,r,o,n,a=function(e){return Math.sin(6.283184*e)},i=function(e){return.003959503758*Math.pow(2,(e-128)/12)},l=function(e,t,r){var o,n,a,l,u,c,f,d=s[e.i[0]],p=e.i[1],y=e.i[3],h=s[e.i[4]],w=e.i[5],v=e.i[8],g=e.i[9],x=e.i[10]*e.i[10]*4,C=e.i[11]*e.i[11]*4,m=e.i[12]*e.i[12]*4,M=1/m,S=e.i[13],D=r*Math.pow(2,2-e.i[14]),A=new Int32Array(x+C+m),Y=0,K=0;for(o=0,n=0;x+C+m>o;o++,n++)0>n||(n-=D,c=i(t+(15&(S=S>>8|(255&S)<<4))+e.i[2]-128),f=i(t+(15&S)+e.i[6]-128)*(1+8e-4*e.i[7])),a=1,x>o?a=o/x:x+C>o||(a-=(o-x-C)*M),l=c,y&&(l*=a*a),u=d(Y+=l)*p,l=f,v&&(l*=a*a),u+=h(K+=l)*w,g&&(u+=(2*Math.random()-1)*g),A[o]=80*u*a|0;return A},s=[a,function(e){return.5>e%1?1:-1},function(e){return e%1*2-1},function(e){var t=e%1*4;return 2>t?t-1:3-t}];this.init=function(a){e=a,t=a.endPattern,r=0,o=a.rowLen*a.patternLen*(t+1)*2,n=new Int32Array(o)},this.generate=function(){var i,u,c,f,d,p,y,h,w,v,g,x,C,m,M=new Int32Array(o),S=e.songData[r],D=e.rowLen,A=e.patternLen,Y=0,K=0,X=!1,E=[];for(c=0;t>=c;++c)for(y=S.p[c],f=0;A>f;++f){var I=y?S.c[y-1].f[f]:0;I&&(S.i[I-1]=S.c[y-1].f[f+A]||0,16>I&&(E=[]));var b=s[S.i[15]],P=S.i[16]/512,R=Math.pow(2,S.i[17]-9)/D,L=S.i[18],k=S.i[19],T=43.23529*S.i[20]*3.141592/44100,z=1-S.i[21]/255,V=1e-5*S.i[22],F=S.i[23]/32,U=S.i[24]/512,B=6.283184*Math.pow(2,S.i[25]-9)/D,O=S.i[26]/255,H=S.i[27]*D&-2;for(g=(c*A+f)*D,d=0;4>d;++d)if(p=y?S.c[y-1].n[f+d*A]:0){E[p]||(E[p]=l(S,p,D));var G=E[p];for(u=0,i=2*g;u<G.length;u++,i+=2)M[i]+=G[u]}for(u=0;D>u;u++)(v=M[h=2*(g+u)])||X?(x=T,L&&(x*=b(R*h)*P+.5),K+=(x=1.5*Math.sin(x))*(C=z*(v-K)-(Y+=x*K)),v=3==k?K:1==k?C:Y,V&&(v=1>(v*=V)?v>-1?a(.25*v):-1:1,v/=V),X=(v*=F)*v>1e-5,m=v*(1-(w=Math.sin(B*h)*U+.5)),v*=w):m=0,H>h||(m+=M[h-H+1]*O,v+=M[h-H]*O),M[h]=0|m,M[h+1]=0|v,n[h]+=0|m,n[h+1]+=0|v}return++r/e.numChannels},this.createWave=function(){var e=44+2*o-8,t=e-36,r=new Uint8Array(44+2*o);r.set([82,73,70,70,255&e,e>>8&255,e>>16&255,e>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&t,t>>8&255,t>>16&255,t>>24&255]);for(var a=0,i=44;o>a;++a){var l=n[a];l=-32767>l?-32767:l>32767?32767:l,r[i++]=255&l,r[i++]=l>>8&255}return r},this.getBuffer=function(){return n},this.getData=function(e,t){for(var r=2*Math.floor(44100*e),o=new Array(t),a=0;2*t>a;a+=1){var i=r+a;o[a]=e>0&&i<n.length?n[i]/32768:0}return o}},F={songData:[{i:[3,138,116,0,0,138,128,4,0,0,47,48,166,124,3,0,139,4,1,3,64,160,3,32,147,4,121,5],p:[1,1,4,2,3],c:[{n:[111],f:[]},{n:[114],f:[]},{n:[113],f:[]},{n:[112,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,113],f:[]}]}],rowLen:5513,patternLen:32,endPattern:4,numChannels:1};states={},init=(()=>{stats=new Stats,stats.showPanel(1),document.body.appendChild(stats.dom),lcg=new z(1019),drawMap(),state="menu",last=0,t=0,A=new AudioContext,audioMaster=A.createGain(),deadzoneX=50,deadzoneY=50,viewX=player.x-e/2,viewY=player.y-r/2,sounds={},music=new V,music.init(F),done=!1,setInterval(function(){done||(done=1==music.generate(),done&&(wave=music.createWave().buffer,A.decodeAudioData(wave,function(e){sounds.song=e,function(e,t=1,r=0,o=.5,n=!1){var a=A.createBufferSource(),i=A.createGain(),l=A.createStereoPanner();a.buffer=e,a.connect(l),l.connect(i),i.connect(audioMaster),a.playbackRate.value=t,a.loop=n,i.gain.value=o,l.pan.value=r,a.start()}(sounds.song,1,0,.5,!0)})))},0),paused=!1,loop()}),window.addEventListener("keyup",function(e){Key.onKeyup(e)},!1),window.addEventListener("keydown",function(e){Key.onKeydown(e)},!1),window.addEventListener("blur",function(e){paused=!0},!1),window.addEventListener("focus",function(e){paused=!1},!1),loop=(r=>{stats.begin(),paused?(X(22,22),d=0,T(["PAUSED",e/2,128,3,1,"center","top",3,21,0]),audioMaster.gain.value=0):(dt=1,t+=1,audioMaster.gain.value=1,states[state].step(1),states[state].draw()),function(){let e=o;for(;e--;)g[e]=y[pal[x[e]]];h.data.set(v),f.putImageData(h,0,0),function(){let e=o;for(;e--;)D[e]=y[pal[x[e+o]]];m.data.set(M),c.putImageData(m,0,0)}(),f.globalCompositeOperation="overlay",f.drawImage(u,0,0)}(),stats.end(),requestAnimationFrame(loop)}),drawThings=(t=>{d=l,K(0),pat=dither[0],function(e,t){cursorX=0,cursorY=0}(),P(0,0,4,1,1),L(0,0,16,16,22,22),R(0,0,1,1,1,1),E(2,2),b(0,0,1,1,1,1),function(e,t,r,o,n,a=cursorColor,i=cursorColor2){a|=0;for(let e=0;1>=e;e++)L(0+e,0-e,1-2*e,1+2*e,a)}(0,0,0,0,0,1,1),function(e,t,r,o,n=8,a=8,i=cursorColor,l=cursorColor2){cursorColor2=l,cursorColor=i,r/=a,o/=n;for(var s=0;n>s;++s)for(var u=0,c=a/2;c>u;++u)L(2+(2*u*r+(s%2?0:r)),s*o,r-1,o-1,i)}(0,0,2,2,2,2,2,2),function(e=cursorX,t=cursorY,r=5,o=cursorColor,n=cursorColor2){cursorColor2=n,cursorColor=o,e|=0,t|=0,o|=0;var a=-(r|=0),i=0,l=2-2*r;do{E(e-a,t+i),E(e-i,t-a),E(e+a,t-i),E(e+i,t+a),(r=l)>i||(l+=2*++i+1),(r>a||l>i)&&(l+=2*++a+1)}while(0>a)}(1,1,2,1,1),function(e,t,r,o,n,a,i=cursorColor,l=cursorColor2){cursorColor2=l,cursorColor=i,b(0,1,0,1,i),b(0,1,0,1,i),b(0,1,0,1,i)}(0,0,0,0,0,0,1,1),function(e=cursorX,t=cursorY,r,o,n=cursorColor,a=cursorColor2){cursorColor2=a,cursorColor=n;let i,l=2+(e|=0)|0,s=2+(t|=0)|0,u=Math.abs(l-e),c=Math.abs(s-t),f=1&c,d=4*(1-u)*c*c,p=4*(f+1)*u*u,y=d+p+f*u*u;e>l&&(e=l,l+=u),t>s&&(t=s),s=(t+=(c+1)/2)-f,u*=8*u,f=8*c*c;do{E(l,t),E(e,t),E(e,s),E(l,s),(i=2*y)>p||(t++,s--,y+=p+=u),d>i&&p>=2*y||(e++,l--,y+=d+=f)}while(l>=e);for(;c>t-s;)E(e-1,t),E(l+1,t++),E(e-1,s),E(l+1,s--)}(1,1,0,0,1,1),function(t=cursorX,r=cursorY,o=d){let n=function(t=cursorX,r=cursorY,o=d){return x[o+t+r*e]}(t,r,o);if(n!=cursorColor&&n!=cursorColor2)for(floodStack=[],I(o+t+r*e,n);floodStack.length>0;)I(floodStack.pop(),n)}(2,2,l),function(t=0,o=0,n=e,a=r,i=0,l=0,s=!1,u=!1,c=pal){t|=0,o|=0,n|=0,a|=0,i|=0,l|=0;for(var f=0;a>f;f++)for(var y=0;n>y;y++)r>l+f&&e>i+y&&l+f>-1&&i+y>-1&&(s&u?0>x[p+((o+(a-f))*e+t+(n-y))]||(x[d+((l+f)*e+i+y)]=c[x[p+((o+(a-f-1))*e+t+(n-y-1))]]):u&&!s?0>x[p+((o+(a-f))*e+t+y)]||(x[d+((l+f)*e+i+y)]=c[x[p+((o+(a-f-1))*e+t+y)]]):s&&!u?0>x[p+((o+f)*e+t+(n-y-1))]||(x[d+((l+f)*e+i+y)]=c[x[p+((o+f)*e+t+(n-y-1))]]):s||u||0>x[p+((o+f)*e+t+y)]||(x[d+((l+f)*e+i+y)]=c[x[p+((o+f)*e+t+y)]]))}(0,0,0,0,0,0,0,1),function(t,o,n,a,i,l,s,u,c=pal){let f=Math.cos(-0)*(1/0),y=Math.sin(-0)*(1/0);for(let t=-5;5>t;t++)for(let o=-5;5>o;o++){let n=0+Math.round(f*o+y*t),a=0+Math.round(-y*o+f*t),i=o+0|0,l=t+0|0;i>0&&e>i&&l>0&&r>l&&n>=0&&a>=0&&0>n&&0>a&&x[p+(n+0)+(a+0)*e]>0&&(x[d+i+l*e]=c[x[p+(n+0)+(a+0)*e]])}}(),function(t=0,o=0,n=16,a=16,i=0,l=0,s=16,u=16,c=pal){t|=0,o|=0,i|=0,l|=0;for(var f=(n|=0)/(s|=0),y=(a|=0)/(u|=0),h=0;u>h;h++)for(var w=0;s>w;w++)px=w*f|0,py=h*y|0,r>l+h&&e>i+w&&l+h>-1&&i+w>-1&&x[p+((o+py)*e+t+px)]>0&&(x[d+((l+h)*e+i+w)]=c[x[p+((o+py)*e+t+px)]])}(0,0,0,0,0,0,0,0),function(t,o,n=cursorColor,a=cursorColor2,i=n,l=n){cursorColor2=a,cursorColor=n;for(let s=0;e>=s;s++)for(let u=0;r>=u;u++){let r=s-1+u*e,c=s+1+u*e,f=s+(u+1)*e,d=s+(u-1)*e;x[t+(s+u*e)]&&(x[t+r]||(x[o+r]=n),x[t+c]||(x[o+c]=i),x[t+d]||(x[o+d]=a),x[t+f]||(x[o+f]=l))}}(l,l,1,2,3,4),X(22,0),K(0),d=0}),drawMap=(t=>{d=i,X(1,1),R(1,1,e,r,1);for(let t=0;6e3>t;t++)E(lcg.nextIntRange(1,e),lcg.nextIntRange(1,r));d=0}),getGID=((t,r)=>i+(t/16|0)+(r/16|0)*e),getTile=((e,t)=>x[getGID(e,t)]),player={x:500,y:500,xVel:0,yVel:0,xVelMax:400,yVelMax:400,oldX:0,oldY:0,speedX:50,speedY:50,width:6,height:8,color:25,tx:0,ty:0,gid:0,draw:function(){L(this.x-viewX,this.y-viewY,this.x-viewX+this.width,this.y-viewY+this.height,this.color,this.color-1)},update:function(){player.oldX=player.x,player.oldY=player.y,player.yVel+=4,Key.isDown(Key.d)||Key.isDown(Key.RIGHT)?player.xVel=player.speedX:(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(player.xVel=-player.speedY),Key.isDown(Key.w)||Key.isDown(Key.UP)?player.yVel-=20:Key.isDown(Key.s)||Key.isDown(Key.DOWN),player.x+=1*player.xVel/60,player.y+=1*player.yVel/60,1==getTile(player.x,player.y)&&(player.xVel=0,player.yVel=0,player.x=player.oldX,player.y=player.oldY),Key.isDown(Key.SPACE)&&console.log(getGID(player.x,player.y)+", "+getTile(player.x,player.y))},updatePosition:function(){this.tx=this.x/16|0,this.ty=this.y/16|0,this.gid=i+this.tx+this.ty*e}},states.menu={step:function(e){Key.justReleased(Key.SPACE)&&(state="game")},draw:function(t){d=0,K(0),L(0,0,20,20,4),T(["OFFLINE\nGAME",e/2,100,3,9,"center","top",5,21,0]),T(["PRESS SPACE TO PLAY",e/2,190,3,9,"center","top",2,21,0])}},states.game={step:function(e){player.update(e),player.updatePosition(),player.x-viewX+deadzoneX>viewW?viewX=player.x-(viewW-deadzoneX):player.x-deadzoneX<viewX&&(viewX=player.x-deadzoneX),player.y-viewY+deadzoneY>viewH?viewY=player.y-(viewH-deadzoneY):player.y-deadzoneY<viewY&&(viewY=player.y-deadzoneY)},draw:function(t){pat=dither[8],d=n,K(0),L(0,0,e,r,2),d=0,K(0);for(let t=0;e>t;t++)for(let o=0;r>o;o++)if(1==x[i+o*e+t]){let e=16*t-viewX,r=16*o-viewY;Y(e,r,16)&&(L(e+1,r+1,e+16-1,r+16-1,8,7),R(e,r,e+16+1,r+16+1,6,7),d=n,P(e+8,r+8,32,5,5),d=0)}else{let e=16*t-viewX,r=16*o-viewY;Y(e,r,16)&&(L(e,r,e+16,r+16,2,1),R(e,r,e+16,r+16,2,3))}player.draw()}},window.init()}();